<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover" />
<title>湊齊10000元</title>
<style>
  :root {
    --bg: #f9fafb;
    --panel: #ffffff;
    --border: #d1d5db;
    --text: #1e293b;
    --muted: #6b7280;
    --primary: #0071e3;
    --primary-hover: #0062c8;
    --primary-press-top: #0a67c9;
    --primary-press-bottom: #084d98;
    --ok: #16a34a;
    --warn: #f59e0b;
    --err: #dc2626;
    --radius: 12px;
  }

  * { box-sizing: border-box; }
  body {
    margin: 0;
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "SF Pro Display", "Helvetica Neue", Helvetica, Arial, sans-serif;
    background: var(--bg);
    color: var(--text);
    line-height: 1.6;
  }

  header { padding: 28px 20px 12px; text-align: center; }
  h1 { font-size: 24px; font-weight: 700; margin: 0; color: var(--text); letter-spacing: -0.3px; }
  .sub { font-size: 14px; color: var(--muted); margin-top: 4px; }

  .card {
    background: var(--panel);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 20px;
    margin: 20px auto;
    width: min(92%, 520px);
    box-shadow: 0 2px 8px rgba(0,0,0,.04);
  }

  .field { display:flex; flex-direction: column; gap: 6px; margin-bottom: 16px; }
  label { font-weight: 600; font-size: 15px; }
  input[type="number"] {
    width: 100%;
    padding: 12px 14px;
    border: 1px solid var(--border);
    border-radius: var(--radius);
    font-size: 16px;
    background: #fff;
    color: var(--text);
    outline: none;
    transition: border .2s ease, box-shadow .2s ease, transform .06s ease;
  }
  input[type="number"]::placeholder { color: #9ca3af; }
  input[type="number"]:focus { border-color: var(--primary); box-shadow: 0 0 0 4px rgba(0,113,227,.15); }
  input[type="number"]::-webkit-outer-spin-button,
  input[type="number"]::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
  input[type="number"] { -moz-appearance: textfield; }

  .btns { display:flex; flex-direction: column; gap: 12px; margin-top: 8px; }
  button {
    width: 100%;
    padding: 14px 16px;
    border: none;
    border-radius: 14px;
    font-size: 17px;
    font-weight: 600;
    letter-spacing: .3px;
    cursor: pointer;
    transition: transform .06s ease, box-shadow .2s ease, background .2s ease;
  }
  button.primary {
    color: #fff;
    background: linear-gradient(180deg, var(--primary), #066ddc);
    box-shadow: 0 8px 16px rgba(0,113,227,.25), 0 2px 4px rgba(0,0,0,.08);
  }
  button.primary:hover {
    background: linear-gradient(180deg, var(--primary-hover), #065cb8);
    box-shadow: 0 10px 20px rgba(0,113,227,.28), 0 3px 6px rgba(0,0,0,.10);
  }
  button.primary:active {
    background: linear-gradient(180deg, var(--primary-press-top), var(--primary-press-bottom));
    transform: translateY(1px);
    box-shadow: 0 4px 10px rgba(0,0,0,.18) inset, 0 2px 4px rgba(0,0,0,.08);
  }
  button.secondary { background: #f3f4f6; color: var(--text); box-shadow: 0 2px 4px rgba(0,0,0,.04); }
  button.secondary:hover { background: #e5e7eb; }
  button.secondary:active { transform: translateY(1px); box-shadow: 0 1px 2px rgba(0,0,0,.08) inset; }

  .result { margin-top: 24px; display:flex; flex-direction: column; gap: 16px; }
  .status { text-align: center; font-weight: 700; font-size: 17px; }
  .status.ok { color: var(--ok); }
  .status.warn { color: var(--warn); }
  .status.err { color: var(--err); }

  .result-title { font-size: 16px; font-weight: 700; }
  .result-note { color: var(--muted); font-size: 13px; margin-top: -6px; }

  .result-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
    gap: 12px;
  }
  .coin {
    background: #f9fafb;
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 12px;
    text-align: center;
  }
  .coin .denom { font-size: 14px; color: var(--muted); }
  .coin .count {
    margin-top: 4px;
    font-size: 30px;
    font-weight: 800;
    color: var(--primary);
  }

  .panel {
    background: #f9fafb;
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 12px 16px;
  }
  .row { display:flex; justify-content: space-between; font-size: 15px; padding: 4px 0; }
  .row .label { color: var(--muted); }
  .row .value { font-weight: 700; }
</style>
</head>
<body>
  <header>
    <h1>湊齊10000元</h1>
    <div class="sub">小面額優先；若無法剛好，顯示最接近 10000 的結果。</div>
  </header>

  <section class="card">
    <div class="field">
      <label for="c1000">1000 元可用數量</label>
      <input id="c1000" type="number" min="0" step="1" placeholder="請輸入數量">
    </div>
    <div class="field">
      <label for="c500">500 元可用數量</label>
      <input id="c500" type="number" min="0" step="1" placeholder="請輸入數量">
    </div>
    <div class="field">
      <label for="c100">100 元可用數量</label>
      <input id="c100" type="number" min="0" step="1" placeholder="請輸入數量">
    </div>
    <div class="field">
      <label for="c50">50 元可用數量</label>
      <input id="c50" type="number" min="0" step="1" placeholder="請輸入數量">
    </div>
    <div class="field">
      <label for="c10">10 元可用數量</label>
      <input id="c10" type="number" min="0" step="1" placeholder="請輸入數量">
    </div>
    <div class="field">
      <label for="c1">1 元可用數量</label>
      <input id="c1" type="number" min="0" step="1" placeholder="請輸入數量">
    </div>

    <div class="btns">
      <button id="calcBtn" class="primary">計算</button>
      <button id="resetBtn" class="secondary">清空</button>
    </div>

    <div id="result" class="result"></div>
    <div id="result-end" style="height:1px;"></div>
  </section>

<script>
const TARGET = 10000;

function getInputs() {
  const num = id => {
    const v = document.getElementById(id).value.trim();
    if (v === "") return 0;
    const n = parseInt(v, 10);
    return isNaN(n) ? 0 : Math.max(0, n);
  };
  return {
    1000: num('c1000'),
    500:  num('c500'),
    100:  num('c100'),
    50:   num('c50'),
    10:   num('c10'),
    1:    num('c1')
  };
}

function totalInputAmount(avail) {
  return avail[1000]*1000 + avail[500]*500 + avail[100]*100 + avail[50]*50 + avail[10]*10 + avail[1];
}
function totalValue(avail) {
  return 1000*avail[1000] + 500*avail[500] + 100*avail[100] + 50*avail[50] + 10*avail[10] + 1*avail[1];
}

function solveExactForTarget(target, avail) {
  // 不再限制 500 元至少 6 張
  const max1 = Math.min(avail[1], target);
  for (let use1 = max1 - (max1 % 10); use1 >= 0; use1 -= 10) {
    let remAfter1 = target - use1;
    let max10 = Math.min(avail[10], Math.floor(remAfter1 / 10));
    const needMod5 = (remAfter1 / 10) % 5;
    max10 = max10 - ((max10 - needMod5 + 5) % 5);

    for (let use10 = max10; use10 >= 0; use10 -= 5) {
      let remAfter10 = remAfter1 - 10 * use10;
      let max50 = Math.min(avail[50], Math.floor(remAfter10 / 50));
      const parity = (remAfter10 / 50) % 2;
      if ((max50 % 2) !== parity) max50--;

      for (let use50 = max50; use50 >= 0; use50 -= 2) {
        let remAfter50 = remAfter10 - 50 * use50;
        let use100 = Math.min(avail[100], Math.floor(remAfter50 / 100));
        let remAfter100 = remAfter50 - 100 * use100;

        if (remAfter100 % 500 !== 0) continue;

        const units = remAfter100 / 500;
        let best = allocate500and1000(units, avail[500], avail[1000]);
        if (!best) continue;

        let { use500, use1000 } = best;

        return {1000:use1000, 500:use500, 100:use100, 50:use50, 10:use10, 1:use1, sum: target};
      }
    }
  }
  return null;
}

function allocate500and1000(units, avail500, avail1000) {
  let a = Math.min(avail500, units);
  if ((units - a) % 2 !== 0) a -= 1;
  for (; a >= 0; a--) {
    const b = (units - a) / 2;
    if (b >= 0 && b <= avail1000 && Number.isInteger(b)) return { use500: a, use1000: b };
  }
  return null;
}

function solveClosest(target, avail) {
  let exact = solveExactForTarget(target, avail);
  if (exact) return exact;
  const maxUp = totalValue(avail);
  const maxRadius = Math.max(target, maxUp - target);

  for (let d = 1; d <= maxRadius; d++) {
    const lower = target - d;
    const upper = target + d;
    if (lower >= 0) {
      const resL = solveExactForTarget(lower, avail);
      if (resL) return resL;
    }
    if (upper <= maxUp) {
      const resU = solveExactForTarget(upper, avail);
      if (resU) return resU;
    }
  }
  return null;
}

function coinBox(label, count) {
  return `
    <div class="coin" role="group" aria-label="${label} 使用數量">
      <div class="denom">${label}</div>
      <div class="count">${count}</div>
    </div>
  `;
}

function renderResult(sol, target, avail) {
  const el = document.getElementById('result');
  if (!sol) {
    el.innerHTML = `<div class="status err">無法找到符合條件的組合。</div>`;
    return;
  }

  const diff = sol.sum - target;
  const status = (diff === 0)
    ? `<div class="status ok">已剛好湊齊 10000 元</div>`
    : `<div class="status warn">無法剛好 10000，最接近的結果（${diff > 0 ? "超過" : "不足"} ${Math.abs(diff)} 元）</div>`;

  const title = `<div class="result-title">數量組合</div>
                 <div class="result-note">下列藍色數字為各面額的「使用數量」。</div>`;

  const grid = `
    <div class="result-grid">
      ${coinBox("1000 元", sol[1000] || 0)}
      ${coinBox("500 元",  sol[500])}
      ${coinBox("100 元",  sol[100])}
      ${coinBox("50 元",   sol[50])}
      ${coinBox("10 元",   sol[10])}
      ${coinBox("1 元",    sol[1])}
    </div>
  `;

  const deltaPanel = `
    <div class="panel">
      <div class="row"><div class="label">與 10000 的差</div><div class="value">${diff > 0 ? "+" : ""}${diff}</div></div>
    </div>
  `;

  const inputTotal = totalInputAmount(avail).toLocaleString();
  const inputTotalPanel = `
    <div class="panel">
      <div class="row"><div class="label">總金額（依輸入數量 × 面額）</div><div class="value">${inputTotal}</div></div>
    </div>
  `;

  el.innerHTML = status + title + grid + deltaPanel + inputTotalPanel;
}

function scrollToResult() {
  const anchor = document.getElementById('result-end');
  if (anchor) anchor.scrollIntoView({ behavior: 'smooth', block: 'start' });
}

document.getElementById('calcBtn').addEventListener('click', () => {
  const avail = getInputs();
  const sol = solveClosest(TARGET, avail);
  renderResult(sol, TARGET, avail);
  requestAnimationFrame(scrollToResult);
});

document.getElementById('resetBtn').addEventListener('click', () => {
  for (const id of ['c1000','c500','c100','c50','c10','c1']) document.getElementById(id).value = '';
  document.getElementById('result').innerHTML = '';
  window.scrollTo({ top: 0, behavior: 'smooth' });
});
</script>
</body>
</html>
